#Copy User Profile to Network Share
$UserToCopy = "Controller"; $YourUNCPath = "\\127.0.0.1\test2"; $EncodedScript = "ZnVuY3Rpb24gQ29weUZpbGVzew0KCXBhcmFtKFtzdHJpbmddJFNyYywgW3N0cmluZ10kRm9sZGVyKQ0KCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFwkVXNyXCRGb2xkZXIpKXsNCgkJTmV3LUl0ZW0gJERlc3RcJFVzclwkRm9sZGVyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglHZXQtQ2hpbGRJdGVtICRTcmMgLVJlY3Vyc2UgLUZvcmNlIHwgU29ydC1PYmplY3QgLVByb3BlcnR5IEZ1bGxOYW1lIC1EZXNjZW5kaW5nIHwgRm9yRWFjaC1PYmplY3Qgew0KCQlpZiAoJF8uRGlyZWN0b3J5KXsNCgkJCSRTdHJEaXIgPSBbc3RyaW5nXSRfLkRpcmVjdG9yeQ0KCQkJJFN1YkRpcnMgPSAkU3RyRGlyLnJlcGxhY2UoJFNyYywiIikNCgkJCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFN1YiRTdWJEaXJzKSl7DQoJCQkJJEZ1bGxQYXRoID0gIiREZXN0U3ViJFN1YkRpcnMiDQoJCQkJJERpcmVjdG9yeUFycmF5ID0gJEZ1bGxQYXRoLnNwbGl0KCJcIikNCgkJCQkkRGlyZWN0b3J5QnVmZmVyID0gIiINCgkJCQkkRGlyZWN0b3J5QXJyYXkgfCBGb3JFYWNoLU9iamVjdCB7DQoJCQkJCSREaXJlY3RvcnlCdWZmZXIgKz0gIiRfXCINCgkJCQkJaWYgKCEoVGVzdC1QYXRoICREaXJlY3RvcnlCdWZmZXIpKXsNCgkJCQkJCU5ldy1JdGVtICREaXJlY3RvcnlCdWZmZXIgLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgfCBPdXQtTnVsbA0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCSRGaWxlID0gJF8uRnVsbE5hbWUNCgkJJERTVEZpbGVOYW1lID0gJEZpbGUuUmVwbGFjZSgkU3JjLCIiKQ0KCQlpZiAoIShUZXN0LVBhdGggJERlc3RTdWIkRFNURmlsZU5hbWUpKXsNCgkJCUNvcHktSXRlbSAiJEZpbGUiIC1EZXN0aW5hdGlvbiAiJERlc3RTdWIkRFNURmlsZU5hbWUiIC1Gb3JjZQ0KCQl9DQoJfQ0KfQ0KZnVuY3Rpb24gUGFzdGVGaWxlc3sNCglwYXJhbShbc3RyaW5nXSRSZXBvLCBbc3RyaW5nXSRGb2xkZXIpDQoJQ29weS1JdGVtICRSZXBvXCRVc3JcJEZvbGRlciAkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KfQ0KZnVuY3Rpb24gVGFrZVByb2ZpbGUoJFVzciwgJERlc3Qpew0KCWlmICghKCRDdXJyZW50VXNlclByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpKSl7DQoJCWlmICghKCRVc3IgLWVxICRFbnY6VXNlck5hbWUpKXsNCgkJCVdyaXRlLUhvc3QgIkVSUk9SOiBObyBBZG1pbmlzdHJhdG9yIGFjY2Vzcy4gQ2FuIG9ubHkgY29weSBvdGhlciBwcm9maWxlcyB3aGVuIHJ1biBhcyBBZG1pbmlzdHJhdG9yISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCgkkRm9sZGVyc1RvQ29weSA9IEAoIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggLVBhdGggJERlc3RcJFVzcil7DQoJCVdyaXRlLUhvc3QgIlVzZXIgSUQgQWxyZWFkeSBFeGlzdHMiDQoJCSRPdmVyd3JpdGUgPSBSZWFkLUhvc3QgIk92ZXJ3cml0ZSBleGlzdGluZyBkYXRhPyAoeSxuKSINCgkJaWYgKCRPdmVyd3JpdGUgLWVxICJ5Iil7DQoJCQlXcml0ZS1Ib3N0ICJPdmVyd3JpdGluZy4uLiINCgkJCXJlbW92ZS1pdGVtICREZXN0XCRVc3IgLUZvcmNlIC1SZWN1cnNlDQoJCX0NCgkJZWxzZXsNCgkJCWV4aXQNCgkJfQ0KCX0NCgllbHNlew0KCQlOZXctSXRlbSAkRGVzdFwkVXNyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglXcml0ZS1Ib3N0ICJDb3B5aW5nIEhvbWUgRm9sZGVyIENvbnRlbnRzIg0KCUdldC1DaGlsZEl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcIHwgRm9yZWFjaC1PYmplY3R7DQoJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAtRGVzdGluYXRpb24gIiREZXN0XCRVc3JcIg0KCQl9DQoJCWVsc2V7DQoJCQlpZiAoIShUZXN0LVBhdGggJERlc3RcJFVzclxSb290Rm9sZGVycykpew0KCQkJCU5ldy1JdGVtICREZXN0XCRVc3JcUm9vdEZvbGRlcnMgLUl0ZW1UeXBlIERpcmVjdG9yeSB8IE91dC1OdWxsDQoJCQl9DQoJCQlpZiAoW3N0cmluZ10kXyAtbmUgIkNvbnRhY3RzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEZXNrdG9wIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEb2N1bWVudHMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIkRvd25sb2FkcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiRmF2b3JpdGVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJNdXNpYyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiUGljdHVyZXMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlZpZGVvcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiM0QgT2JqZWN0cyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiTGlua3MiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlNhdmVkIEdhbWVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJTZWFyY2hlcyIgLWFuZCAhKCRfIC1tYXRjaCAiT25lRHJpdmUiKSl7DQoJCQkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclwkXyIgLVJlY3Vyc2UgLURlc3RpbmF0aW9uICIkRGVzdFwkVXNyXFJvb3RGb2xkZXJzIg0KCQkJfQ0KCQl9DQoJfQ0KCSRGb2xkZXJzVG9Db3B5IHwgRm9yZWFjaC1PYmplY3R7DQoJCVdyaXRlLUhvc3QgIkNvcHlpbmcgJF8gRm9sZGVyIg0KCQkkRGVzdFN1YiA9ICIkRGVzdFwkVXNyXCRfIg0KCQlDb3B5RmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAiJF8iDQoJfQ0KCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCWlmICgkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiY2hyb21lLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygibXNlZGdlLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiZmlyZWZveCIpKXsNCgkJR2V0LVByb2Nlc3MgLU5hbWUgY2hyb21lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgU3RvcC1Qcm9jZXNzIC1Gb3JjZQ0KCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCUdldC1Qcm9jZXNzIC1OYW1lIGZpcmVmb3ggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJfQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIpew0KCQlXcml0ZS1Ib3N0ICJDb3B5aW5nIENocm9tZSBEYXRhIg0KCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcQ2hyb21lRGF0YVxEZWZhdWx0IC1SZWN1cnNlDQoJfQ0KCVdyaXRlLUhvc3QgIkNvcHlpbmcgRWRnZSBEYXRhIg0KCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRWRnZURhdGFcRGVmYXVsdCAtUmVjdXJzZQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJV3JpdGUtSG9zdCAiQ29weWluZyBGaXJlZm94IERhdGEiDQoJCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgLVJlY3Vyc2UNCgkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pDQoJfQ0KfQ0KZnVuY3Rpb24gUHV0UHJvZmlsZSgkVXNyLCAkUmVwbywgJERlc3RQcm9maWxlKXsNCgkkVmFsaWRQYXN0ZVByb2ZpbGVzID0gQCgpDQoJJEZvbGRlcnNUb1Bhc3RlID0gQCgiUm9vdEZvbGRlcnNcKiIsIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3Ipew0KCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBDb250ZW50cyINCgkJCUdldC1DaGlsZEl0ZW0gJFJlcG9cJFVzciB8IEZvcmVhY2gtT2JqZWN0ew0KCQkJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQkJCUNvcHktSXRlbSAiJFJlcG9cJFVzclwkXyIgLURlc3RpbmF0aW9uICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXCINCgkJCQl9DQoJCQl9DQoJCQkkRm9sZGVyc1RvcGFzdGUgfCBGb3JlYWNoLU9iamVjdHsNCgkJCQlpZiAoW3N0cmluZ10kXyAtZXEgIlJvb3RGb2xkZXJzXCoiKXsNCgkJCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBGb2xkZXJzIg0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nICRfIEZvbGRlciINCgkJCQl9DQoJCQkJUGFzdGVGaWxlcyAiJFJlcG8iICIkXyINCgkJCX0NCgkJCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCQkJaWYgKCRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJjaHJvbWUuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJtc2VkZ2UuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJmaXJlZm94Iikpew0KCQkJCUdldC1Qcm9jZXNzIC1OYW1lIGNocm9tZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCQkJR2V0LVByb2Nlc3MgLU5hbWUgZmlyZWZveCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCX0NCgkJCWlmIChUZXN0LVBhdGggJFJlcG9cJFVzclxDaHJvbWVEYXRhXERlZmF1bHQpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgQ2hyb21lIERhdGEgRm9sZGVyIg0KCQkJCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0Iil7DQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJfQ0KCQkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXENocm9tZURhdGFcRGVmYXVsdCAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXEdvb2dsZVxDaHJvbWVcVXNlciBEYXRhXERlZmF1bHQiIC1Gb3JjZSAtUmVjdXJzZQ0KCQkJfQ0KDQoJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nIEVkZ2UgRGF0YSBGb2xkZXIiDQoJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcTWljcm9zb2Z0XEVkZ2VcVXNlciBEYXRhXERlZmF1bHQiKXsNCgkJCQlyZW1vdmUtaXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXE1pY3Jvc29mdFxFZGdlXFVzZXIgRGF0YVxEZWZhdWx0IiAtRm9yY2UgLVJlY3Vyc2UNCgkJCX0NCgkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXEVkZ2VEYXRhXERlZmF1bHQgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgRmlyZWZveCBEYXRhIEZvbGRlciINCgkJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJCQkJcmVtb3ZlLWl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hccHJvZmlsZXMuaW5pIiAtRm9yY2UNCgkJCQl9DQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pICAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSINCgkJCX0NCgkJfQ0KCQllbHNlew0KCQkJV3JpdGUtSG9zdCAiVXNlciBQcm9maWxlIE5vdCBGb3VuZCEiDQoJCQlzbGVlcCA1DQoJCQlleGl0DQoJCX0NCgl9DQoJZWxzZXsNCgkJV3JpdGUtSG9zdCAiSW52YWxpZCBTb3VyY2UgUGF0aCEiDQoJCXNsZWVwIDUNCgkJZXhpdA0KCX0NCn0NCiNTVEFSVCBIRVJFDQokU3lzdGVtRHJpdmUgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlN5c3RlbURyaXZlDQokQ3VycmVudFVzZXJQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQ0KaWYgKFtzdHJpbmddJGFyZ3NbMF0gLWVxICItYyIpew0KCSRVc3IgPSAkRW52OlVzZXJOYW1lDQoJJE1vZGUgPSAiYyINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1wIil7DQoJJE1vZGUgPSAicCINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1oIil7DQoJV3JpdGUtSG9zdCAiVXNhZ2U6Ig0KCVdyaXRlLUhvc3QgIi5cVGhpc1Byb2dyYW0ucHMxIFtPUFRJT05TXSA8UHJvZmlsZSB0byBDb3B5IG9yIFBhc3RlIGZyb20+IDxTb3VyY2Ugb3IgRGVzdGluYXRpb24gUGF0aD4gPFByb2ZpbGUgdG8gUGFzdGUgdG8+Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE9QVElPTlM6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IC1jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29weSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1wICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXN0ZSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpbnQgVGhpcyBQYWdlIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE5PVEU6IDxQcm9maWxlIHRvIFBhc3RlIHRvPiBpcyBvbmx5IHZhbGlkIGluIFBhc3RlIG1vZGUhICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCWV4aXQNCn0NCmVsc2V7DQoJJE1vZGUgPSBSZWFkLUhvc3QgIldvdWxkIHlvdSBsaWtlIHRvIGNvcHkgb3IgcGFzdGUgcHJvZmlsZT8gKGMscCkiDQp9DQppZiAoJE1vZGUgLWVxICJjIil7DQoJaWYgKFtzdHJpbmddJGFyZ3NbMV0pew0KCQlpZiAoW3N0cmluZ10kYXJnc1syXSl7DQoJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkYXJnc1syXQ0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJGFyZ3NbMl0gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRVc3IgJGFyZ3NbMl0NCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCX0NCgkJZWxzZXsNCgkJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkUmVwbw0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJFJlcG8gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRhcmdzWzFdICRSZXBvDQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlOZXctSXRlbSAtUGF0aCAkUmVwbyAtSXRlbVR5cGUgIkRpcmVjdG9yeSIgfCBPdXQtTnVsbA0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJfQ0KfQ0KZWxzZWlmICgkTW9kZSAtZXEgInAiKXsNCglpZiAoW3N0cmluZ10kYXJnc1sxXSl7DQoJCWlmIChbc3RyaW5nXSRhcmdzWzJdKXsNCgkJCWlmIChbc3RyaW5nXSRhcmdzWzNdKXsNCgkJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkJJFZhbGlkU291cmNlUHJvZmlsZXMgPSBAKCkNCgkJCQkJR2V0LUNoaWxkaXRlbSAkYXJnc1syXSB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19DQoJCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCQlzbGVlcCA1DQoJCQkJCQlleGl0DQoJCQkJCX0NCgkJCQkJJFZhbGlkRGVzdFByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCQlpZiAoJFZhbGlkRGVzdFByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzNdKSl7DQoJCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdDQoJCQkJCX0NCgkJCQkJZWxzZXsNCgkJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIGRlc3RpbmF0aW9uIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlXcml0ZS1Ib3N0ICRhcmdzWzJdDQoJCQkJaWYgKFRlc3QtUGF0aCAkYXJnc1syXSl7DQoJCQkJCSRWYWxpZFNvdXJjZVByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJGFyZ3NbMl0gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpeyRWYWxpZFNvdXJjZVByb2ZpbGVzICs9ICRfLlRvU3RyaW5nKCl9fQ0KCQkJCQlpZiAoISgkVmFsaWRTb3VyY2VQcm9maWxlcy5Db250YWlucyhbc3RyaW5nXSRhcmdzWzFdKSkpew0KCQkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQuIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQkkUmVwbyA9IFJlYWQtSG9zdCAiRW50ZXIgcHJvZmlsZSByZXBvc2l0b3J5IHBhdGgiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFJlcG8gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHByb2ZpbGUgc291cmNlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRSZXBvICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciBwcm9maWxlIHJlcG9zaXRvcnkgcGF0aCINCgkJaWYgKFRlc3QtUGF0aCAkUmVwbyl7DQoJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkUmVwbyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCSRVc3JTb3VyY2UgPSBSZWFkLUhvc3QgIldoaWNoIHByb2ZpbGUgd291bGQgeW91IGxpa2UgdG8gcGFzdGUgZnJvbT8iDQoJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoJFVzclNvdXJjZSkpew0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRVc3JTb3VyY2UgJFJlcG8gJFVzckRlc3QNCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkludmFsaWQgU2VsZWN0aW9uISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlXcml0ZS1Ib3N0ICJJbnZhbGlkIHByb2ZpbGUgcmVwb3NpdG9yeSBwYXRoISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCn0NCmVsc2V7DQoJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCXNsZWVwIDUNCglleGl0DQp9DQpXcml0ZS1Ib3N0ICJEb25lIg0KI0VORCBIRVJF"; $DecodedScript = [System.Convert]::FromBase64String($EncodedScript); Set-Content -Path C:\Migrate.ps1 -Value $DecodedScript -Encoding Byte; net use W: $YourUNCPath; C:\Migrate.ps1 -c $UserToCopy W:; net use W: /delete

#Copy All User Profiles to Network Share
$YourUNCPath = "\\MYSERVER\MYSHARE"; $EncodedScript = "ZnVuY3Rpb24gQ29weUZpbGVzew0KCXBhcmFtKFtzdHJpbmddJFNyYywgW3N0cmluZ10kRm9sZGVyKQ0KCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFwkVXNyXCRGb2xkZXIpKXsNCgkJTmV3LUl0ZW0gJERlc3RcJFVzclwkRm9sZGVyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglHZXQtQ2hpbGRJdGVtICRTcmMgLVJlY3Vyc2UgLUZvcmNlIHwgU29ydC1PYmplY3QgLVByb3BlcnR5IEZ1bGxOYW1lIC1EZXNjZW5kaW5nIHwgRm9yRWFjaC1PYmplY3Qgew0KCQlpZiAoJF8uRGlyZWN0b3J5KXsNCgkJCSRTdHJEaXIgPSBbc3RyaW5nXSRfLkRpcmVjdG9yeQ0KCQkJJFN1YkRpcnMgPSAkU3RyRGlyLnJlcGxhY2UoJFNyYywiIikNCgkJCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFN1YiRTdWJEaXJzKSl7DQoJCQkJJEZ1bGxQYXRoID0gIiREZXN0U3ViJFN1YkRpcnMiDQoJCQkJJERpcmVjdG9yeUFycmF5ID0gJEZ1bGxQYXRoLnNwbGl0KCJcIikNCgkJCQkkRGlyZWN0b3J5QnVmZmVyID0gIiINCgkJCQkkRGlyZWN0b3J5QXJyYXkgfCBGb3JFYWNoLU9iamVjdCB7DQoJCQkJCSREaXJlY3RvcnlCdWZmZXIgKz0gIiRfXCINCgkJCQkJaWYgKCEoVGVzdC1QYXRoICREaXJlY3RvcnlCdWZmZXIpKXsNCgkJCQkJCU5ldy1JdGVtICREaXJlY3RvcnlCdWZmZXIgLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgfCBPdXQtTnVsbA0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCSRGaWxlID0gJF8uRnVsbE5hbWUNCgkJJERTVEZpbGVOYW1lID0gJEZpbGUuUmVwbGFjZSgkU3JjLCIiKQ0KCQlpZiAoIShUZXN0LVBhdGggJERlc3RTdWIkRFNURmlsZU5hbWUpKXsNCgkJCUNvcHktSXRlbSAiJEZpbGUiIC1EZXN0aW5hdGlvbiAiJERlc3RTdWIkRFNURmlsZU5hbWUiIC1Gb3JjZQ0KCQl9DQoJfQ0KfQ0KZnVuY3Rpb24gUGFzdGVGaWxlc3sNCglwYXJhbShbc3RyaW5nXSRSZXBvLCBbc3RyaW5nXSRGb2xkZXIpDQoJQ29weS1JdGVtICRSZXBvXCRVc3JcJEZvbGRlciAkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KfQ0KZnVuY3Rpb24gVGFrZVByb2ZpbGUoJFVzciwgJERlc3Qpew0KCWlmICghKCRDdXJyZW50VXNlclByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpKSl7DQoJCWlmICghKCRVc3IgLWVxICRFbnY6VXNlck5hbWUpKXsNCgkJCVdyaXRlLUhvc3QgIkVSUk9SOiBObyBBZG1pbmlzdHJhdG9yIGFjY2Vzcy4gQ2FuIG9ubHkgY29weSBvdGhlciBwcm9maWxlcyB3aGVuIHJ1biBhcyBBZG1pbmlzdHJhdG9yISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCgkkRm9sZGVyc1RvQ29weSA9IEAoIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggLVBhdGggJERlc3RcJFVzcil7DQoJCVdyaXRlLUhvc3QgIlVzZXIgSUQgQWxyZWFkeSBFeGlzdHMiDQoJCSRPdmVyd3JpdGUgPSBSZWFkLUhvc3QgIk92ZXJ3cml0ZSBleGlzdGluZyBkYXRhPyAoeSxuKSINCgkJaWYgKCRPdmVyd3JpdGUgLWVxICJ5Iil7DQoJCQlXcml0ZS1Ib3N0ICJPdmVyd3JpdGluZy4uLiINCgkJCXJlbW92ZS1pdGVtICREZXN0XCRVc3IgLUZvcmNlIC1SZWN1cnNlDQoJCX0NCgkJZWxzZXsNCgkJCWV4aXQNCgkJfQ0KCX0NCgllbHNlew0KCQlOZXctSXRlbSAkRGVzdFwkVXNyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglXcml0ZS1Ib3N0ICJDb3B5aW5nIEhvbWUgRm9sZGVyIENvbnRlbnRzIg0KCUdldC1DaGlsZEl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcIHwgRm9yZWFjaC1PYmplY3R7DQoJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAtRGVzdGluYXRpb24gIiREZXN0XCRVc3JcIg0KCQl9DQoJCWVsc2V7DQoJCQlpZiAoIShUZXN0LVBhdGggJERlc3RcJFVzclxSb290Rm9sZGVycykpew0KCQkJCU5ldy1JdGVtICREZXN0XCRVc3JcUm9vdEZvbGRlcnMgLUl0ZW1UeXBlIERpcmVjdG9yeSB8IE91dC1OdWxsDQoJCQl9DQoJCQlpZiAoW3N0cmluZ10kXyAtbmUgIkNvbnRhY3RzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEZXNrdG9wIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEb2N1bWVudHMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIkRvd25sb2FkcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiRmF2b3JpdGVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJNdXNpYyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiUGljdHVyZXMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlZpZGVvcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiM0QgT2JqZWN0cyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiTGlua3MiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlNhdmVkIEdhbWVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJTZWFyY2hlcyIgLWFuZCAhKCRfIC1tYXRjaCAiT25lRHJpdmUiKSl7DQoJCQkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclwkXyIgLVJlY3Vyc2UgLURlc3RpbmF0aW9uICIkRGVzdFwkVXNyXFJvb3RGb2xkZXJzIg0KCQkJfQ0KCQl9DQoJfQ0KCSRGb2xkZXJzVG9Db3B5IHwgRm9yZWFjaC1PYmplY3R7DQoJCVdyaXRlLUhvc3QgIkNvcHlpbmcgJF8gRm9sZGVyIg0KCQkkRGVzdFN1YiA9ICIkRGVzdFwkVXNyXCRfIg0KCQlDb3B5RmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAiJF8iDQoJfQ0KCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCWlmICgkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiY2hyb21lLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygibXNlZGdlLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiZmlyZWZveCIpKXsNCgkJR2V0LVByb2Nlc3MgLU5hbWUgY2hyb21lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgU3RvcC1Qcm9jZXNzIC1Gb3JjZQ0KCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCUdldC1Qcm9jZXNzIC1OYW1lIGZpcmVmb3ggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJfQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIpew0KCQlXcml0ZS1Ib3N0ICJDb3B5aW5nIENocm9tZSBEYXRhIg0KCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcQ2hyb21lRGF0YVxEZWZhdWx0IC1SZWN1cnNlDQoJfQ0KCVdyaXRlLUhvc3QgIkNvcHlpbmcgRWRnZSBEYXRhIg0KCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRWRnZURhdGFcRGVmYXVsdCAtUmVjdXJzZQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJV3JpdGUtSG9zdCAiQ29weWluZyBGaXJlZm94IERhdGEiDQoJCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgLVJlY3Vyc2UNCgkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pDQoJfQ0KfQ0KZnVuY3Rpb24gUHV0UHJvZmlsZSgkVXNyLCAkUmVwbywgJERlc3RQcm9maWxlKXsNCgkkVmFsaWRQYXN0ZVByb2ZpbGVzID0gQCgpDQoJJEZvbGRlcnNUb1Bhc3RlID0gQCgiUm9vdEZvbGRlcnNcKiIsIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3Ipew0KCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBDb250ZW50cyINCgkJCUdldC1DaGlsZEl0ZW0gJFJlcG9cJFVzciB8IEZvcmVhY2gtT2JqZWN0ew0KCQkJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQkJCUNvcHktSXRlbSAiJFJlcG9cJFVzclwkXyIgLURlc3RpbmF0aW9uICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXCINCgkJCQl9DQoJCQl9DQoJCQkkRm9sZGVyc1RvcGFzdGUgfCBGb3JlYWNoLU9iamVjdHsNCgkJCQlpZiAoW3N0cmluZ10kXyAtZXEgIlJvb3RGb2xkZXJzXCoiKXsNCgkJCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBGb2xkZXJzIg0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nICRfIEZvbGRlciINCgkJCQl9DQoJCQkJUGFzdGVGaWxlcyAiJFJlcG8iICIkXyINCgkJCX0NCgkJCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCQkJaWYgKCRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJjaHJvbWUuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJtc2VkZ2UuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJmaXJlZm94Iikpew0KCQkJCUdldC1Qcm9jZXNzIC1OYW1lIGNocm9tZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCQkJR2V0LVByb2Nlc3MgLU5hbWUgZmlyZWZveCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCX0NCgkJCWlmIChUZXN0LVBhdGggJFJlcG9cJFVzclxDaHJvbWVEYXRhXERlZmF1bHQpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgQ2hyb21lIERhdGEgRm9sZGVyIg0KCQkJCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0Iil7DQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJfQ0KCQkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXENocm9tZURhdGFcRGVmYXVsdCAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXEdvb2dsZVxDaHJvbWVcVXNlciBEYXRhXERlZmF1bHQiIC1Gb3JjZSAtUmVjdXJzZQ0KCQkJfQ0KDQoJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nIEVkZ2UgRGF0YSBGb2xkZXIiDQoJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcTWljcm9zb2Z0XEVkZ2VcVXNlciBEYXRhXERlZmF1bHQiKXsNCgkJCQlyZW1vdmUtaXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXE1pY3Jvc29mdFxFZGdlXFVzZXIgRGF0YVxEZWZhdWx0IiAtRm9yY2UgLVJlY3Vyc2UNCgkJCX0NCgkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXEVkZ2VEYXRhXERlZmF1bHQgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgRmlyZWZveCBEYXRhIEZvbGRlciINCgkJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJCQkJcmVtb3ZlLWl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hccHJvZmlsZXMuaW5pIiAtRm9yY2UNCgkJCQl9DQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pICAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSINCgkJCX0NCgkJfQ0KCQllbHNlew0KCQkJV3JpdGUtSG9zdCAiVXNlciBQcm9maWxlIE5vdCBGb3VuZCEiDQoJCQlzbGVlcCA1DQoJCQlleGl0DQoJCX0NCgl9DQoJZWxzZXsNCgkJV3JpdGUtSG9zdCAiSW52YWxpZCBTb3VyY2UgUGF0aCEiDQoJCXNsZWVwIDUNCgkJZXhpdA0KCX0NCn0NCiNTVEFSVCBIRVJFDQokU3lzdGVtRHJpdmUgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlN5c3RlbURyaXZlDQokQ3VycmVudFVzZXJQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQ0KaWYgKFtzdHJpbmddJGFyZ3NbMF0gLWVxICItYyIpew0KCSRVc3IgPSAkRW52OlVzZXJOYW1lDQoJJE1vZGUgPSAiYyINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1wIil7DQoJJE1vZGUgPSAicCINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1oIil7DQoJV3JpdGUtSG9zdCAiVXNhZ2U6Ig0KCVdyaXRlLUhvc3QgIi5cVGhpc1Byb2dyYW0ucHMxIFtPUFRJT05TXSA8UHJvZmlsZSB0byBDb3B5IG9yIFBhc3RlIGZyb20+IDxTb3VyY2Ugb3IgRGVzdGluYXRpb24gUGF0aD4gPFByb2ZpbGUgdG8gUGFzdGUgdG8+Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE9QVElPTlM6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IC1jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29weSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1wICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXN0ZSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpbnQgVGhpcyBQYWdlIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE5PVEU6IDxQcm9maWxlIHRvIFBhc3RlIHRvPiBpcyBvbmx5IHZhbGlkIGluIFBhc3RlIG1vZGUhICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCWV4aXQNCn0NCmVsc2V7DQoJJE1vZGUgPSBSZWFkLUhvc3QgIldvdWxkIHlvdSBsaWtlIHRvIGNvcHkgb3IgcGFzdGUgcHJvZmlsZT8gKGMscCkiDQp9DQppZiAoJE1vZGUgLWVxICJjIil7DQoJaWYgKFtzdHJpbmddJGFyZ3NbMV0pew0KCQlpZiAoW3N0cmluZ10kYXJnc1syXSl7DQoJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkYXJnc1syXQ0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJGFyZ3NbMl0gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRVc3IgJGFyZ3NbMl0NCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCX0NCgkJZWxzZXsNCgkJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkUmVwbw0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJFJlcG8gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRhcmdzWzFdICRSZXBvDQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlOZXctSXRlbSAtUGF0aCAkUmVwbyAtSXRlbVR5cGUgIkRpcmVjdG9yeSIgfCBPdXQtTnVsbA0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJfQ0KfQ0KZWxzZWlmICgkTW9kZSAtZXEgInAiKXsNCglpZiAoW3N0cmluZ10kYXJnc1sxXSl7DQoJCWlmIChbc3RyaW5nXSRhcmdzWzJdKXsNCgkJCWlmIChbc3RyaW5nXSRhcmdzWzNdKXsNCgkJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkJJFZhbGlkU291cmNlUHJvZmlsZXMgPSBAKCkNCgkJCQkJR2V0LUNoaWxkaXRlbSAkYXJnc1syXSB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19DQoJCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCQlzbGVlcCA1DQoJCQkJCQlleGl0DQoJCQkJCX0NCgkJCQkJJFZhbGlkRGVzdFByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCQlpZiAoJFZhbGlkRGVzdFByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzNdKSl7DQoJCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdDQoJCQkJCX0NCgkJCQkJZWxzZXsNCgkJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIGRlc3RpbmF0aW9uIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlXcml0ZS1Ib3N0ICRhcmdzWzJdDQoJCQkJaWYgKFRlc3QtUGF0aCAkYXJnc1syXSl7DQoJCQkJCSRWYWxpZFNvdXJjZVByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJGFyZ3NbMl0gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpeyRWYWxpZFNvdXJjZVByb2ZpbGVzICs9ICRfLlRvU3RyaW5nKCl9fQ0KCQkJCQlpZiAoISgkVmFsaWRTb3VyY2VQcm9maWxlcy5Db250YWlucyhbc3RyaW5nXSRhcmdzWzFdKSkpew0KCQkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQuIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQkkUmVwbyA9IFJlYWQtSG9zdCAiRW50ZXIgcHJvZmlsZSByZXBvc2l0b3J5IHBhdGgiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFJlcG8gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHByb2ZpbGUgc291cmNlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRSZXBvICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciBwcm9maWxlIHJlcG9zaXRvcnkgcGF0aCINCgkJaWYgKFRlc3QtUGF0aCAkUmVwbyl7DQoJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkUmVwbyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCSRVc3JTb3VyY2UgPSBSZWFkLUhvc3QgIldoaWNoIHByb2ZpbGUgd291bGQgeW91IGxpa2UgdG8gcGFzdGUgZnJvbT8iDQoJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoJFVzclNvdXJjZSkpew0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRVc3JTb3VyY2UgJFJlcG8gJFVzckRlc3QNCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkludmFsaWQgU2VsZWN0aW9uISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlXcml0ZS1Ib3N0ICJJbnZhbGlkIHByb2ZpbGUgcmVwb3NpdG9yeSBwYXRoISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCn0NCmVsc2V7DQoJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCXNsZWVwIDUNCglleGl0DQp9DQpXcml0ZS1Ib3N0ICJEb25lIg0KI0VORCBIRVJF"; $DecodedScript = [System.Convert]::FromBase64String($EncodedScript); Set-Content -Path C:\Migrate.ps1 -Value $DecodedScript -Encoding Byte; net use W: $YourUNCPath; Get-Childitem C:\Users | Foreach-Object{if(!($_.directory)){if ($_.Name -ne "Public"){C:\Migrate.ps1 -c $_ W:}}}; net use W: /delete

#Copy User Profile by Computer Name as Defined in CSV
$YourUNCPath = "\\MYSERVER\MYSHARE"; $EncodedCSV = "MY_BASE64_ENCODED_CSV"; $DecodedCSV = [System.Convert]::FromBase64String($EncodedCSV); Set-Content -Path C:\UserComputers.csv -Value $DecodedCSV -Encoding Byte; $UserToCopy = $((Import-Csv C:\UserComputers.csv | Where-Object {$_.Computer -in $((hostname))} | Select User)).User; Write-Host "Copying $UserToCopy"; $EncodedScript = "ZnVuY3Rpb24gQ29weUZpbGVzew0KCXBhcmFtKFtzdHJpbmddJFNyYywgW3N0cmluZ10kRm9sZGVyKQ0KCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFwkVXNyXCRGb2xkZXIpKXsNCgkJTmV3LUl0ZW0gJERlc3RcJFVzclwkRm9sZGVyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglHZXQtQ2hpbGRJdGVtICRTcmMgLVJlY3Vyc2UgLUZvcmNlIHwgU29ydC1PYmplY3QgLVByb3BlcnR5IEZ1bGxOYW1lIC1EZXNjZW5kaW5nIHwgRm9yRWFjaC1PYmplY3Qgew0KCQlpZiAoJF8uRGlyZWN0b3J5KXsNCgkJCSRTdHJEaXIgPSBbc3RyaW5nXSRfLkRpcmVjdG9yeQ0KCQkJJFN1YkRpcnMgPSAkU3RyRGlyLnJlcGxhY2UoJFNyYywiIikNCgkJCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFN1YiRTdWJEaXJzKSl7DQoJCQkJJEZ1bGxQYXRoID0gIiREZXN0U3ViJFN1YkRpcnMiDQoJCQkJJERpcmVjdG9yeUFycmF5ID0gJEZ1bGxQYXRoLnNwbGl0KCJcIikNCgkJCQkkRGlyZWN0b3J5QnVmZmVyID0gIiINCgkJCQkkRGlyZWN0b3J5QXJyYXkgfCBGb3JFYWNoLU9iamVjdCB7DQoJCQkJCSREaXJlY3RvcnlCdWZmZXIgKz0gIiRfXCINCgkJCQkJaWYgKCEoVGVzdC1QYXRoICREaXJlY3RvcnlCdWZmZXIpKXsNCgkJCQkJCU5ldy1JdGVtICREaXJlY3RvcnlCdWZmZXIgLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgfCBPdXQtTnVsbA0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCSRGaWxlID0gJF8uRnVsbE5hbWUNCgkJJERTVEZpbGVOYW1lID0gJEZpbGUuUmVwbGFjZSgkU3JjLCIiKQ0KCQlpZiAoIShUZXN0LVBhdGggJERlc3RTdWIkRFNURmlsZU5hbWUpKXsNCgkJCUNvcHktSXRlbSAiJEZpbGUiIC1EZXN0aW5hdGlvbiAiJERlc3RTdWIkRFNURmlsZU5hbWUiIC1Gb3JjZQ0KCQl9DQoJfQ0KfQ0KZnVuY3Rpb24gUGFzdGVGaWxlc3sNCglwYXJhbShbc3RyaW5nXSRSZXBvLCBbc3RyaW5nXSRGb2xkZXIpDQoJQ29weS1JdGVtICRSZXBvXCRVc3JcJEZvbGRlciAkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KfQ0KZnVuY3Rpb24gVGFrZVByb2ZpbGUoJFVzciwgJERlc3Qpew0KCWlmICghKCRDdXJyZW50VXNlclByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpKSl7DQoJCWlmICghKCRVc3IgLWVxICRFbnY6VXNlck5hbWUpKXsNCgkJCVdyaXRlLUhvc3QgIkVSUk9SOiBObyBBZG1pbmlzdHJhdG9yIGFjY2Vzcy4gQ2FuIG9ubHkgY29weSBvdGhlciBwcm9maWxlcyB3aGVuIHJ1biBhcyBBZG1pbmlzdHJhdG9yISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCgkkRm9sZGVyc1RvQ29weSA9IEAoIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggLVBhdGggJERlc3RcJFVzcil7DQoJCVdyaXRlLUhvc3QgIlVzZXIgSUQgQWxyZWFkeSBFeGlzdHMiDQoJCSRPdmVyd3JpdGUgPSBSZWFkLUhvc3QgIk92ZXJ3cml0ZSBleGlzdGluZyBkYXRhPyAoeSxuKSINCgkJaWYgKCRPdmVyd3JpdGUgLWVxICJ5Iil7DQoJCQlXcml0ZS1Ib3N0ICJPdmVyd3JpdGluZy4uLiINCgkJCXJlbW92ZS1pdGVtICREZXN0XCRVc3IgLUZvcmNlIC1SZWN1cnNlDQoJCX0NCgkJZWxzZXsNCgkJCWV4aXQNCgkJfQ0KCX0NCgllbHNlew0KCQlOZXctSXRlbSAkRGVzdFwkVXNyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglXcml0ZS1Ib3N0ICJDb3B5aW5nIEhvbWUgRm9sZGVyIENvbnRlbnRzIg0KCUdldC1DaGlsZEl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcIHwgRm9yZWFjaC1PYmplY3R7DQoJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAtRGVzdGluYXRpb24gIiREZXN0XCRVc3JcIg0KCQl9DQoJCWVsc2V7DQoJCQlpZiAoIShUZXN0LVBhdGggJERlc3RcJFVzclxSb290Rm9sZGVycykpew0KCQkJCU5ldy1JdGVtICREZXN0XCRVc3JcUm9vdEZvbGRlcnMgLUl0ZW1UeXBlIERpcmVjdG9yeSB8IE91dC1OdWxsDQoJCQl9DQoJCQlpZiAoW3N0cmluZ10kXyAtbmUgIkNvbnRhY3RzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEZXNrdG9wIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEb2N1bWVudHMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIkRvd25sb2FkcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiRmF2b3JpdGVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJNdXNpYyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiUGljdHVyZXMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlZpZGVvcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiM0QgT2JqZWN0cyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiTGlua3MiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlNhdmVkIEdhbWVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJTZWFyY2hlcyIgLWFuZCAhKCRfIC1tYXRjaCAiT25lRHJpdmUiKSl7DQoJCQkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclwkXyIgLVJlY3Vyc2UgLURlc3RpbmF0aW9uICIkRGVzdFwkVXNyXFJvb3RGb2xkZXJzIg0KCQkJfQ0KCQl9DQoJfQ0KCSRGb2xkZXJzVG9Db3B5IHwgRm9yZWFjaC1PYmplY3R7DQoJCVdyaXRlLUhvc3QgIkNvcHlpbmcgJF8gRm9sZGVyIg0KCQkkRGVzdFN1YiA9ICIkRGVzdFwkVXNyXCRfIg0KCQlDb3B5RmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAiJF8iDQoJfQ0KCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCWlmICgkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiY2hyb21lLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygibXNlZGdlLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiZmlyZWZveCIpKXsNCgkJR2V0LVByb2Nlc3MgLU5hbWUgY2hyb21lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgU3RvcC1Qcm9jZXNzIC1Gb3JjZQ0KCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCUdldC1Qcm9jZXNzIC1OYW1lIGZpcmVmb3ggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJfQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIpew0KCQlXcml0ZS1Ib3N0ICJDb3B5aW5nIENocm9tZSBEYXRhIg0KCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcQ2hyb21lRGF0YVxEZWZhdWx0IC1SZWN1cnNlDQoJfQ0KCVdyaXRlLUhvc3QgIkNvcHlpbmcgRWRnZSBEYXRhIg0KCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRWRnZURhdGFcRGVmYXVsdCAtUmVjdXJzZQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJV3JpdGUtSG9zdCAiQ29weWluZyBGaXJlZm94IERhdGEiDQoJCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgLVJlY3Vyc2UNCgkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pDQoJfQ0KfQ0KZnVuY3Rpb24gUHV0UHJvZmlsZSgkVXNyLCAkUmVwbywgJERlc3RQcm9maWxlKXsNCgkkVmFsaWRQYXN0ZVByb2ZpbGVzID0gQCgpDQoJJEZvbGRlcnNUb1Bhc3RlID0gQCgiUm9vdEZvbGRlcnNcKiIsIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3Ipew0KCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBDb250ZW50cyINCgkJCUdldC1DaGlsZEl0ZW0gJFJlcG9cJFVzciB8IEZvcmVhY2gtT2JqZWN0ew0KCQkJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQkJCUNvcHktSXRlbSAiJFJlcG9cJFVzclwkXyIgLURlc3RpbmF0aW9uICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXCINCgkJCQl9DQoJCQl9DQoJCQkkRm9sZGVyc1RvcGFzdGUgfCBGb3JlYWNoLU9iamVjdHsNCgkJCQlpZiAoW3N0cmluZ10kXyAtZXEgIlJvb3RGb2xkZXJzXCoiKXsNCgkJCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBGb2xkZXJzIg0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nICRfIEZvbGRlciINCgkJCQl9DQoJCQkJUGFzdGVGaWxlcyAiJFJlcG8iICIkXyINCgkJCX0NCgkJCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCQkJaWYgKCRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJjaHJvbWUuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJtc2VkZ2UuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJmaXJlZm94Iikpew0KCQkJCUdldC1Qcm9jZXNzIC1OYW1lIGNocm9tZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCQkJR2V0LVByb2Nlc3MgLU5hbWUgZmlyZWZveCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCX0NCgkJCWlmIChUZXN0LVBhdGggJFJlcG9cJFVzclxDaHJvbWVEYXRhXERlZmF1bHQpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgQ2hyb21lIERhdGEgRm9sZGVyIg0KCQkJCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0Iil7DQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJfQ0KCQkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXENocm9tZURhdGFcRGVmYXVsdCAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXEdvb2dsZVxDaHJvbWVcVXNlciBEYXRhXERlZmF1bHQiIC1Gb3JjZSAtUmVjdXJzZQ0KCQkJfQ0KDQoJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nIEVkZ2UgRGF0YSBGb2xkZXIiDQoJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcTWljcm9zb2Z0XEVkZ2VcVXNlciBEYXRhXERlZmF1bHQiKXsNCgkJCQlyZW1vdmUtaXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXE1pY3Jvc29mdFxFZGdlXFVzZXIgRGF0YVxEZWZhdWx0IiAtRm9yY2UgLVJlY3Vyc2UNCgkJCX0NCgkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXEVkZ2VEYXRhXERlZmF1bHQgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgRmlyZWZveCBEYXRhIEZvbGRlciINCgkJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJCQkJcmVtb3ZlLWl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hccHJvZmlsZXMuaW5pIiAtRm9yY2UNCgkJCQl9DQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pICAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSINCgkJCX0NCgkJfQ0KCQllbHNlew0KCQkJV3JpdGUtSG9zdCAiVXNlciBQcm9maWxlIE5vdCBGb3VuZCEiDQoJCQlzbGVlcCA1DQoJCQlleGl0DQoJCX0NCgl9DQoJZWxzZXsNCgkJV3JpdGUtSG9zdCAiSW52YWxpZCBTb3VyY2UgUGF0aCEiDQoJCXNsZWVwIDUNCgkJZXhpdA0KCX0NCn0NCiNTVEFSVCBIRVJFDQokU3lzdGVtRHJpdmUgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlN5c3RlbURyaXZlDQokQ3VycmVudFVzZXJQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQ0KaWYgKFtzdHJpbmddJGFyZ3NbMF0gLWVxICItYyIpew0KCSRVc3IgPSAkRW52OlVzZXJOYW1lDQoJJE1vZGUgPSAiYyINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1wIil7DQoJJE1vZGUgPSAicCINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1oIil7DQoJV3JpdGUtSG9zdCAiVXNhZ2U6Ig0KCVdyaXRlLUhvc3QgIi5cVGhpc1Byb2dyYW0ucHMxIFtPUFRJT05TXSA8UHJvZmlsZSB0byBDb3B5IG9yIFBhc3RlIGZyb20+IDxTb3VyY2Ugb3IgRGVzdGluYXRpb24gUGF0aD4gPFByb2ZpbGUgdG8gUGFzdGUgdG8+Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE9QVElPTlM6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IC1jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29weSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1wICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXN0ZSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpbnQgVGhpcyBQYWdlIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE5PVEU6IDxQcm9maWxlIHRvIFBhc3RlIHRvPiBpcyBvbmx5IHZhbGlkIGluIFBhc3RlIG1vZGUhICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCWV4aXQNCn0NCmVsc2V7DQoJJE1vZGUgPSBSZWFkLUhvc3QgIldvdWxkIHlvdSBsaWtlIHRvIGNvcHkgb3IgcGFzdGUgcHJvZmlsZT8gKGMscCkiDQp9DQppZiAoJE1vZGUgLWVxICJjIil7DQoJaWYgKFtzdHJpbmddJGFyZ3NbMV0pew0KCQlpZiAoW3N0cmluZ10kYXJnc1syXSl7DQoJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkYXJnc1syXQ0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJGFyZ3NbMl0gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRVc3IgJGFyZ3NbMl0NCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCX0NCgkJZWxzZXsNCgkJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkUmVwbw0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJFJlcG8gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRhcmdzWzFdICRSZXBvDQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlOZXctSXRlbSAtUGF0aCAkUmVwbyAtSXRlbVR5cGUgIkRpcmVjdG9yeSIgfCBPdXQtTnVsbA0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJfQ0KfQ0KZWxzZWlmICgkTW9kZSAtZXEgInAiKXsNCglpZiAoW3N0cmluZ10kYXJnc1sxXSl7DQoJCWlmIChbc3RyaW5nXSRhcmdzWzJdKXsNCgkJCWlmIChbc3RyaW5nXSRhcmdzWzNdKXsNCgkJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkJJFZhbGlkU291cmNlUHJvZmlsZXMgPSBAKCkNCgkJCQkJR2V0LUNoaWxkaXRlbSAkYXJnc1syXSB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19DQoJCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCQlzbGVlcCA1DQoJCQkJCQlleGl0DQoJCQkJCX0NCgkJCQkJJFZhbGlkRGVzdFByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCQlpZiAoJFZhbGlkRGVzdFByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzNdKSl7DQoJCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdDQoJCQkJCX0NCgkJCQkJZWxzZXsNCgkJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIGRlc3RpbmF0aW9uIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlXcml0ZS1Ib3N0ICRhcmdzWzJdDQoJCQkJaWYgKFRlc3QtUGF0aCAkYXJnc1syXSl7DQoJCQkJCSRWYWxpZFNvdXJjZVByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJGFyZ3NbMl0gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpeyRWYWxpZFNvdXJjZVByb2ZpbGVzICs9ICRfLlRvU3RyaW5nKCl9fQ0KCQkJCQlpZiAoISgkVmFsaWRTb3VyY2VQcm9maWxlcy5Db250YWlucyhbc3RyaW5nXSRhcmdzWzFdKSkpew0KCQkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQuIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQkkUmVwbyA9IFJlYWQtSG9zdCAiRW50ZXIgcHJvZmlsZSByZXBvc2l0b3J5IHBhdGgiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFJlcG8gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHByb2ZpbGUgc291cmNlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRSZXBvICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciBwcm9maWxlIHJlcG9zaXRvcnkgcGF0aCINCgkJaWYgKFRlc3QtUGF0aCAkUmVwbyl7DQoJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkUmVwbyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCSRVc3JTb3VyY2UgPSBSZWFkLUhvc3QgIldoaWNoIHByb2ZpbGUgd291bGQgeW91IGxpa2UgdG8gcGFzdGUgZnJvbT8iDQoJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoJFVzclNvdXJjZSkpew0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRVc3JTb3VyY2UgJFJlcG8gJFVzckRlc3QNCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkludmFsaWQgU2VsZWN0aW9uISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlXcml0ZS1Ib3N0ICJJbnZhbGlkIHByb2ZpbGUgcmVwb3NpdG9yeSBwYXRoISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCn0NCmVsc2V7DQoJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCXNsZWVwIDUNCglleGl0DQp9DQpXcml0ZS1Ib3N0ICJEb25lIg0KI0VORCBIRVJF"; $DecodedScript = [System.Convert]::FromBase64String($EncodedScript); Set-Content -Path C:\Migrate.ps1 -Value $DecodedScript -Encoding Byte; net use W: $YourUNCPath; C:\Migrate.ps1 -c $UserToCopy W:; net use W: /delete

#Paste User Profile from Network Share
$ProfileToPaste= "PROFILENAME"; $UserToPasteTo = "USERNAME"; $YourUNCPath = "\\MYSERVER\MYSHARE"; $EncodedScript = "ZnVuY3Rpb24gQ29weUZpbGVzew0KCXBhcmFtKFtzdHJpbmddJFNyYywgW3N0cmluZ10kRm9sZGVyKQ0KCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFwkVXNyXCRGb2xkZXIpKXsNCgkJTmV3LUl0ZW0gJERlc3RcJFVzclwkRm9sZGVyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglHZXQtQ2hpbGRJdGVtICRTcmMgLVJlY3Vyc2UgLUZvcmNlIHwgU29ydC1PYmplY3QgLVByb3BlcnR5IEZ1bGxOYW1lIC1EZXNjZW5kaW5nIHwgRm9yRWFjaC1PYmplY3Qgew0KCQlpZiAoJF8uRGlyZWN0b3J5KXsNCgkJCSRTdHJEaXIgPSBbc3RyaW5nXSRfLkRpcmVjdG9yeQ0KCQkJJFN1YkRpcnMgPSAkU3RyRGlyLnJlcGxhY2UoJFNyYywiIikNCgkJCWlmICghKFRlc3QtUGF0aCAtUGF0aCAkRGVzdFN1YiRTdWJEaXJzKSl7DQoJCQkJJEZ1bGxQYXRoID0gIiREZXN0U3ViJFN1YkRpcnMiDQoJCQkJJERpcmVjdG9yeUFycmF5ID0gJEZ1bGxQYXRoLnNwbGl0KCJcIikNCgkJCQkkRGlyZWN0b3J5QnVmZmVyID0gIiINCgkJCQkkRGlyZWN0b3J5QXJyYXkgfCBGb3JFYWNoLU9iamVjdCB7DQoJCQkJCSREaXJlY3RvcnlCdWZmZXIgKz0gIiRfXCINCgkJCQkJaWYgKCEoVGVzdC1QYXRoICREaXJlY3RvcnlCdWZmZXIpKXsNCgkJCQkJCU5ldy1JdGVtICREaXJlY3RvcnlCdWZmZXIgLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgfCBPdXQtTnVsbA0KCQkJCQl9DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCSRGaWxlID0gJF8uRnVsbE5hbWUNCgkJJERTVEZpbGVOYW1lID0gJEZpbGUuUmVwbGFjZSgkU3JjLCIiKQ0KCQlpZiAoIShUZXN0LVBhdGggJERlc3RTdWIkRFNURmlsZU5hbWUpKXsNCgkJCUNvcHktSXRlbSAiJEZpbGUiIC1EZXN0aW5hdGlvbiAiJERlc3RTdWIkRFNURmlsZU5hbWUiIC1Gb3JjZQ0KCQl9DQoJfQ0KfQ0KZnVuY3Rpb24gUGFzdGVGaWxlc3sNCglwYXJhbShbc3RyaW5nXSRSZXBvLCBbc3RyaW5nXSRGb2xkZXIpDQoJQ29weS1JdGVtICRSZXBvXCRVc3JcJEZvbGRlciAkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlIC1SZWN1cnNlIC1Gb3JjZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZQ0KfQ0KZnVuY3Rpb24gVGFrZVByb2ZpbGUoJFVzciwgJERlc3Qpew0KCWlmICghKCRDdXJyZW50VXNlclByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpKSl7DQoJCWlmICghKCRVc3IgLWVxICRFbnY6VXNlck5hbWUpKXsNCgkJCVdyaXRlLUhvc3QgIkVSUk9SOiBObyBBZG1pbmlzdHJhdG9yIGFjY2Vzcy4gQ2FuIG9ubHkgY29weSBvdGhlciBwcm9maWxlcyB3aGVuIHJ1biBhcyBBZG1pbmlzdHJhdG9yISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCgkkRm9sZGVyc1RvQ29weSA9IEAoIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggLVBhdGggJERlc3RcJFVzcil7DQoJCVdyaXRlLUhvc3QgIlVzZXIgSUQgQWxyZWFkeSBFeGlzdHMiDQoJCSRPdmVyd3JpdGUgPSBSZWFkLUhvc3QgIk92ZXJ3cml0ZSBleGlzdGluZyBkYXRhPyAoeSxuKSINCgkJaWYgKCRPdmVyd3JpdGUgLWVxICJ5Iil7DQoJCQlXcml0ZS1Ib3N0ICJPdmVyd3JpdGluZy4uLiINCgkJCXJlbW92ZS1pdGVtICREZXN0XCRVc3IgLUZvcmNlIC1SZWN1cnNlDQoJCX0NCgkJZWxzZXsNCgkJCWV4aXQNCgkJfQ0KCX0NCgllbHNlew0KCQlOZXctSXRlbSAkRGVzdFwkVXNyIC1JdGVtVHlwZSBEaXJlY3RvcnkgfCBPdXQtTnVsbA0KCX0NCglXcml0ZS1Ib3N0ICJDb3B5aW5nIEhvbWUgRm9sZGVyIENvbnRlbnRzIg0KCUdldC1DaGlsZEl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcIHwgRm9yZWFjaC1PYmplY3R7DQoJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAtRGVzdGluYXRpb24gIiREZXN0XCRVc3JcIg0KCQl9DQoJCWVsc2V7DQoJCQlpZiAoIShUZXN0LVBhdGggJERlc3RcJFVzclxSb290Rm9sZGVycykpew0KCQkJCU5ldy1JdGVtICREZXN0XCRVc3JcUm9vdEZvbGRlcnMgLUl0ZW1UeXBlIERpcmVjdG9yeSB8IE91dC1OdWxsDQoJCQl9DQoJCQlpZiAoW3N0cmluZ10kXyAtbmUgIkNvbnRhY3RzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEZXNrdG9wIiAtYW5kIFtzdHJpbmddJF8gLW5lICJEb2N1bWVudHMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIkRvd25sb2FkcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiRmF2b3JpdGVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJNdXNpYyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiUGljdHVyZXMiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlZpZGVvcyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiM0QgT2JqZWN0cyIgLWFuZCBbc3RyaW5nXSRfIC1uZSAiTGlua3MiIC1hbmQgW3N0cmluZ10kXyAtbmUgIlNhdmVkIEdhbWVzIiAtYW5kIFtzdHJpbmddJF8gLW5lICJTZWFyY2hlcyIgLWFuZCAhKCRfIC1tYXRjaCAiT25lRHJpdmUiKSl7DQoJCQkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclwkXyIgLVJlY3Vyc2UgLURlc3RpbmF0aW9uICIkRGVzdFwkVXNyXFJvb3RGb2xkZXJzIg0KCQkJfQ0KCQl9DQoJfQ0KCSRGb2xkZXJzVG9Db3B5IHwgRm9yZWFjaC1PYmplY3R7DQoJCVdyaXRlLUhvc3QgIkNvcHlpbmcgJF8gRm9sZGVyIg0KCQkkRGVzdFN1YiA9ICIkRGVzdFwkVXNyXCRfIg0KCQlDb3B5RmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXCRfIiAiJF8iDQoJfQ0KCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCWlmICgkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiY2hyb21lLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygibXNlZGdlLmV4ZSIpIC1vciAkQ3VycmVudFByb2Nlc3Nlcy5Qcm9jZXNzTmFtZS5Db250YWlucygiZmlyZWZveCIpKXsNCgkJR2V0LVByb2Nlc3MgLU5hbWUgY2hyb21lIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgU3RvcC1Qcm9jZXNzIC1Gb3JjZQ0KCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCUdldC1Qcm9jZXNzIC1OYW1lIGZpcmVmb3ggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJfQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIpew0KCQlXcml0ZS1Ib3N0ICJDb3B5aW5nIENocm9tZSBEYXRhIg0KCQlDb3B5LUl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcQ2hyb21lRGF0YVxEZWZhdWx0IC1SZWN1cnNlDQoJfQ0KCVdyaXRlLUhvc3QgIkNvcHlpbmcgRWRnZSBEYXRhIg0KCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRWRnZURhdGFcRGVmYXVsdCAtUmVjdXJzZQ0KCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkVXNyXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJV3JpdGUtSG9zdCAiQ29weWluZyBGaXJlZm94IERhdGEiDQoJCUNvcHktSXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCRVc3JcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgLVJlY3Vyc2UNCgkJQ29weS1JdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJFVzclxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSIgLURlc3RpbmF0aW9uICREZXN0XCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pDQoJfQ0KfQ0KZnVuY3Rpb24gUHV0UHJvZmlsZSgkVXNyLCAkUmVwbywgJERlc3RQcm9maWxlKXsNCgkkVmFsaWRQYXN0ZVByb2ZpbGVzID0gQCgpDQoJJEZvbGRlcnNUb1Bhc3RlID0gQCgiUm9vdEZvbGRlcnNcKiIsIkNvbnRhY3RzIiwiRGVza3RvcCIsIkRvY3VtZW50cyIsIkRvd25sb2FkcyIsIkZhdm9yaXRlcyIsIk11c2ljIiwiUGljdHVyZXMiLCJWaWRlb3MiKQ0KCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3Ipew0KCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBDb250ZW50cyINCgkJCUdldC1DaGlsZEl0ZW0gJFJlcG9cJFVzciB8IEZvcmVhY2gtT2JqZWN0ew0KCQkJCWlmKCRfLkRpcmVjdG9yeSl7DQoJCQkJCUNvcHktSXRlbSAiJFJlcG9cJFVzclwkXyIgLURlc3RpbmF0aW9uICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXCINCgkJCQl9DQoJCQl9DQoJCQkkRm9sZGVyc1RvcGFzdGUgfCBGb3JlYWNoLU9iamVjdHsNCgkJCQlpZiAoW3N0cmluZ10kXyAtZXEgIlJvb3RGb2xkZXJzXCoiKXsNCgkJCQkJV3JpdGUtSG9zdCAiUGFzdGluZyBIb21lIEZvbGRlciBGb2xkZXJzIg0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nICRfIEZvbGRlciINCgkJCQl9DQoJCQkJUGFzdGVGaWxlcyAiJFJlcG8iICIkXyINCgkJCX0NCgkJCSRDdXJyZW50UHJvY2Vzc2VzID0gJCgoZ2V0LXdtaW9iamVjdCB3aW4zMl9wcm9jZXNzIC1jb21wdXRlcm5hbWUgJCgoaG9zdG5hbWUpKSB8IFNlbGVjdC1PYmplY3QgUHJvY2Vzc05hbWUpKQ0KCQkJaWYgKCRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJjaHJvbWUuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJtc2VkZ2UuZXhlIikgLW9yICRDdXJyZW50UHJvY2Vzc2VzLlByb2Nlc3NOYW1lLkNvbnRhaW5zKCJmaXJlZm94Iikpew0KCQkJCUdldC1Qcm9jZXNzIC1OYW1lIGNocm9tZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCQlHZXQtUHJvY2VzcyAtTmFtZSBtc2VkZ2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQoJCQkJR2V0LVByb2Nlc3MgLU5hbWUgZmlyZWZveCAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFN0b3AtUHJvY2VzcyAtRm9yY2UNCgkJCX0NCgkJCWlmIChUZXN0LVBhdGggJFJlcG9cJFVzclxDaHJvbWVEYXRhXERlZmF1bHQpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgQ2hyb21lIERhdGEgRm9sZGVyIg0KCQkJCWlmIChUZXN0LVBhdGggIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0Iil7DQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcR29vZ2xlXENocm9tZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJfQ0KCQkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXENocm9tZURhdGFcRGVmYXVsdCAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXEdvb2dsZVxDaHJvbWVcVXNlciBEYXRhXERlZmF1bHQiIC1Gb3JjZSAtUmVjdXJzZQ0KCQkJfQ0KDQoJCQlXcml0ZS1Ib3N0ICJQYXN0aW5nIEVkZ2UgRGF0YSBGb2xkZXIiDQoJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcTG9jYWxcTWljcm9zb2Z0XEVkZ2VcVXNlciBEYXRhXERlZmF1bHQiKXsNCgkJCQlyZW1vdmUtaXRlbSAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXExvY2FsXE1pY3Jvc29mdFxFZGdlXFVzZXIgRGF0YVxEZWZhdWx0IiAtRm9yY2UgLVJlY3Vyc2UNCgkJCX0NCgkJCUNvcHktSXRlbSAkUmVwb1wkVXNyXEVkZ2VEYXRhXERlZmF1bHQgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcRWRnZVxVc2VyIERhdGFcRGVmYXVsdCIgLUZvcmNlIC1SZWN1cnNlDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMpew0KCQkJCVdyaXRlLUhvc3QgIlBhc3RpbmcgRmlyZWZveCBEYXRhIEZvbGRlciINCgkJCQlpZiAoVGVzdC1QYXRoICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiKXsNCgkJCQkJcmVtb3ZlLWl0ZW0gIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJCXJlbW92ZS1pdGVtICIkU3lzdGVtRHJpdmVcVXNlcnNcJERlc3RQcm9maWxlXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hccHJvZmlsZXMuaW5pIiAtRm9yY2UNCgkJCQl9DQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFcUHJvZmlsZXMgIiRTeXN0ZW1Ecml2ZVxVc2Vyc1wkRGVzdFByb2ZpbGVcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIgLUZvcmNlIC1SZWN1cnNlDQoJCQkJQ29weS1JdGVtICRSZXBvXCRVc3JcRmlyZWZveERhdGFccHJvZmlsZXMuaW5pICAiJFN5c3RlbURyaXZlXFVzZXJzXCREZXN0UHJvZmlsZVxBcHBEYXRhXFJvYW1pbmdcTW96aWxsYVxGaXJlZm94XHByb2ZpbGVzLmluaSINCgkJCX0NCgkJfQ0KCQllbHNlew0KCQkJV3JpdGUtSG9zdCAiVXNlciBQcm9maWxlIE5vdCBGb3VuZCEiDQoJCQlzbGVlcCA1DQoJCQlleGl0DQoJCX0NCgl9DQoJZWxzZXsNCgkJV3JpdGUtSG9zdCAiSW52YWxpZCBTb3VyY2UgUGF0aCEiDQoJCXNsZWVwIDUNCgkJZXhpdA0KCX0NCn0NCiNTVEFSVCBIRVJFDQokU3lzdGVtRHJpdmUgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlN5c3RlbURyaXZlDQokQ3VycmVudFVzZXJQcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKFtTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKQ0KaWYgKFtzdHJpbmddJGFyZ3NbMF0gLWVxICItYyIpew0KCSRVc3IgPSAkRW52OlVzZXJOYW1lDQoJJE1vZGUgPSAiYyINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1wIil7DQoJJE1vZGUgPSAicCINCn0NCmVsc2VpZiAoW3N0cmluZ10kYXJnc1swXSAtZXEgIi1oIil7DQoJV3JpdGUtSG9zdCAiVXNhZ2U6Ig0KCVdyaXRlLUhvc3QgIi5cVGhpc1Byb2dyYW0ucHMxIFtPUFRJT05TXSA8UHJvZmlsZSB0byBDb3B5IG9yIFBhc3RlIGZyb20+IDxTb3VyY2Ugb3IgRGVzdGluYXRpb24gUGF0aD4gPFByb2ZpbGUgdG8gUGFzdGUgdG8+Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE9QVElPTlM6ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IC1jICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29weSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1wICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYXN0ZSBQcm9maWxlIHx8Ig0KCVdyaXRlLUhvc3QgInx8IC1oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJpbnQgVGhpcyBQYWdlIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCVdyaXRlLUhvc3QgInx8IE5PVEU6IDxQcm9maWxlIHRvIFBhc3RlIHRvPiBpcyBvbmx5IHZhbGlkIGluIFBhc3RlIG1vZGUhICAgICAgICAgIHx8Ig0KCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCWV4aXQNCn0NCmVsc2V7DQoJJE1vZGUgPSBSZWFkLUhvc3QgIldvdWxkIHlvdSBsaWtlIHRvIGNvcHkgb3IgcGFzdGUgcHJvZmlsZT8gKGMscCkiDQp9DQppZiAoJE1vZGUgLWVxICJjIil7DQoJaWYgKFtzdHJpbmddJGFyZ3NbMV0pew0KCQlpZiAoW3N0cmluZ10kYXJnc1syXSl7DQoJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkYXJnc1syXQ0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJGFyZ3NbMl0gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRVc3IgJGFyZ3NbMl0NCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCX0NCgkJZWxzZXsNCgkJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzIHwgRm9yZWFjaC1PYmplY3R7aWYoISgkXy5kaXJlY3RvcnkpKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoW3N0cmluZ10kYXJnc1sxXSkpew0KCQkJCQlUYWtlUHJvZmlsZSAkYXJnc1sxXSAkUmVwbw0KCQkJCX0NCgkJCQllbHNlew0KCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCXNsZWVwIDUNCgkJCQkJZXhpdA0KCQkJCX0NCgkJCX0NCgkJCWVsc2V7DQoJCQkJTmV3LUl0ZW0gLVBhdGggJFJlcG8gLUl0ZW1UeXBlICJEaXJlY3RvcnkiIHwgT3V0LU51bGwNCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2VycyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzFdKSl7DQoJCQkJCVRha2VQcm9maWxlICRhcmdzWzFdICRSZXBvDQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciB0aGUgcGF0aCBvZiB0aGUgcmVwb3NpdG9yeSB3aGVyZSB5b3Ugd2lsbCBzdG9yZSB5b3VyIHByb2ZpbGUiDQoJCWlmIChUZXN0LVBhdGggJFJlcG8pew0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlOZXctSXRlbSAtUGF0aCAkUmVwbyAtSXRlbVR5cGUgIkRpcmVjdG9yeSIgfCBPdXQtTnVsbA0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkU3lzdGVtRHJpdmVcVXNlcnMgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX19DQoJCQlXcml0ZS1Ib3N0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iDQoJCQkkVXNyID0gUmVhZC1Ib3N0ICJXaGljaCBwcm9maWxlIHdvdWxkIHlvdSBsaWtlIHRvIGNvcHk/Ig0KCQkJaWYgKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKCRVc3IpKXsNCgkJCQlUYWtlUHJvZmlsZSAkVXNyICRSZXBvDQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwcm9maWxlIHNlbGVjdGVkISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJfQ0KfQ0KZWxzZWlmICgkTW9kZSAtZXEgInAiKXsNCglpZiAoW3N0cmluZ10kYXJnc1sxXSl7DQoJCWlmIChbc3RyaW5nXSRhcmdzWzJdKXsNCgkJCWlmIChbc3RyaW5nXSRhcmdzWzNdKXsNCgkJCQlpZiAoVGVzdC1QYXRoICRhcmdzWzJdKXsNCgkJCQkJJFZhbGlkU291cmNlUHJvZmlsZXMgPSBAKCkNCgkJCQkJR2V0LUNoaWxkaXRlbSAkYXJnc1syXSB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19DQoJCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCQlXcml0ZS1Ib3N0ICJFUlJPUjogSW52YWxpZCBzb3VyY2UgcHJvZmlsZSBzZWxlY3RlZCEiDQoJCQkJCQlzbGVlcCA1DQoJCQkJCQlleGl0DQoJCQkJCX0NCgkJCQkJJFZhbGlkRGVzdFByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJFN5c3RlbURyaXZlXFVzZXJzXCB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7aWYgKCRfLk5hbWUgLW5lICJQdWJsaWMiKXskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCQlpZiAoJFZhbGlkRGVzdFByb2ZpbGVzLkNvbnRhaW5zKCRhcmdzWzNdKSl7DQoJCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRhcmdzWzNdDQoJCQkJCX0NCgkJCQkJZWxzZXsNCgkJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIGRlc3RpbmF0aW9uIHByb2ZpbGUgc2VsZWN0ZWQhIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJfQ0KCQkJZWxzZXsNCgkJCQlXcml0ZS1Ib3N0ICRhcmdzWzJdDQoJCQkJaWYgKFRlc3QtUGF0aCAkYXJnc1syXSl7DQoJCQkJCSRWYWxpZFNvdXJjZVByb2ZpbGVzID0gQCgpDQoJCQkJCUdldC1DaGlsZGl0ZW0gJGFyZ3NbMl0gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpeyRWYWxpZFNvdXJjZVByb2ZpbGVzICs9ICRfLlRvU3RyaW5nKCl9fQ0KCQkJCQlpZiAoISgkVmFsaWRTb3VyY2VQcm9maWxlcy5Db250YWlucyhbc3RyaW5nXSRhcmdzWzFdKSkpew0KCQkJCQkJV3JpdGUtSG9zdCAiRVJST1I6IEludmFsaWQgc291cmNlIHByb2ZpbGUgc2VsZWN0ZWQuIg0KCQkJCQkJc2xlZXAgNQ0KCQkJCQkJZXhpdA0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2V7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHNvdXJjZSBwYXRoISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRhcmdzWzJdICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQkkUmVwbyA9IFJlYWQtSG9zdCAiRW50ZXIgcHJvZmlsZSByZXBvc2l0b3J5IHBhdGgiDQoJCQlpZiAoVGVzdC1QYXRoICRSZXBvKXsNCgkJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJCUdldC1DaGlsZGl0ZW0gJFJlcG8gfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7JFZhbGlkU291cmNlUHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCWlmICghKCRWYWxpZFNvdXJjZVByb2ZpbGVzLkNvbnRhaW5zKFtzdHJpbmddJGFyZ3NbMV0pKSl7DQoJCQkJCVdyaXRlLUhvc3QgIkVSUk9SOiBJbnZhbGlkIHByb2ZpbGUgc291cmNlIHNlbGVjdGVkISINCgkJCQkJc2xlZXAgNQ0KCQkJCQlleGl0DQoJCQkJfQ0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRhcmdzWzFdICRSZXBvICRVc3JEZXN0DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7DQoJCSRSZXBvID0gUmVhZC1Ib3N0ICJFbnRlciBwcm9maWxlIHJlcG9zaXRvcnkgcGF0aCINCgkJaWYgKFRlc3QtUGF0aCAkUmVwbyl7DQoJCQkkVmFsaWRTb3VyY2VQcm9maWxlcyA9IEAoKQ0KCQkJV3JpdGUtSG9zdCAiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ig0KCQkJR2V0LUNoaWxkaXRlbSAkUmVwbyB8IEZvcmVhY2gtT2JqZWN0e2lmKCEoJF8uZGlyZWN0b3J5KSl7V3JpdGUtSG9zdCAkXzskVmFsaWRTb3VyY2VQcm9maWxlcyArPSAkXy5Ub1N0cmluZygpfX0NCgkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCSRVc3JTb3VyY2UgPSBSZWFkLUhvc3QgIldoaWNoIHByb2ZpbGUgd291bGQgeW91IGxpa2UgdG8gcGFzdGUgZnJvbT8iDQoJCQlpZiAoJFZhbGlkU291cmNlUHJvZmlsZXMuQ29udGFpbnMoJFVzclNvdXJjZSkpew0KCQkJCSRWYWxpZERlc3RQcm9maWxlcyA9IEAoKQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQlHZXQtQ2hpbGRpdGVtICRTeXN0ZW1Ecml2ZVxVc2Vyc1wgfCBGb3JlYWNoLU9iamVjdHtpZighKCRfLmRpcmVjdG9yeSkpe2lmICgkXy5OYW1lIC1uZSAiUHVibGljIil7V3JpdGUtSG9zdCAkXzskVmFsaWREZXN0UHJvZmlsZXMgKz0gJF8uVG9TdHJpbmcoKX19fQ0KCQkJCVdyaXRlLUhvc3QgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSINCgkJCQkkVXNyRGVzdCA9IFJlYWQtSG9zdCAiV2hpY2ggcHJvZmlsZSB3b3VsZCB5b3UgbGlrZSB0byBwYXN0ZSB0bz8iDQoJCQkJaWYgKCRWYWxpZERlc3RQcm9maWxlcy5Db250YWlucygkVXNyRGVzdCkpew0KCQkJCQlQdXRQcm9maWxlICRVc3JTb3VyY2UgJFJlcG8gJFVzckRlc3QNCgkJCQl9DQoJCQkJZWxzZXsNCgkJCQkJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCQkJCQlzbGVlcCA1DQoJCQkJCWV4aXQNCgkJCQl9DQoJCQl9DQoJCQllbHNlew0KCQkJCVdyaXRlLUhvc3QgIkludmFsaWQgU2VsZWN0aW9uISINCgkJCQlzbGVlcCA1DQoJCQkJZXhpdA0KCQkJfQ0KCQl9DQoJCWVsc2V7DQoJCQlXcml0ZS1Ib3N0ICJJbnZhbGlkIHByb2ZpbGUgcmVwb3NpdG9yeSBwYXRoISINCgkJCXNsZWVwIDUNCgkJCWV4aXQNCgkJfQ0KCX0NCn0NCmVsc2V7DQoJV3JpdGUtSG9zdCAiSW52YWxpZCBTZWxlY3Rpb24hIg0KCXNsZWVwIDUNCglleGl0DQp9DQpXcml0ZS1Ib3N0ICJEb25lIg0KI0VORCBIRVJF"; $DecodedScript = [System.Convert]::FromBase64String($EncodedScript); Set-Content -Path C:\Migrate.ps1 -Value $DecodedScript -Encoding Byte; net use W: $YourUNCPath; C:\Migrate.ps1 -p $ProfileToPaste W: $UserToPasteTo; net use W: /delete
